<!DOCTYPE html>
<meta charset="UTF-8">
<HTML>
	<HEAD>
		<script type="text/JavaScript">
		

			function tester(){
				
				var Rectangles = [];
				var Images = [];
				
				var Rectangle1 = new Rectangle(8, 4);
				var Rectangle2 = new Rectangle(8, 4);
				var Rectangle3 = new Rectangle(8, 4);
				var Rectangle4 = new Rectangle(8, 4);
				var Rectangle5 = new Rectangle(8, 4);
				var Rectangle6 = new Rectangle(8, 4);
				
				Rectangles.push(Rectangle1);
				Rectangles.push(Rectangle2);
				Rectangles.push(Rectangle3);
				Rectangles.push(Rectangle4);
				Rectangles.push(Rectangle5);
				Rectangles.push(Rectangle6);
				
				var Image1 = new Image(200, 200, "a");
				var Image2 = new Image(100, 200, "b");
				var Image3 = new Image(100, 200, "c");
				var Image4 = new Image(400, 200, "d");
				var Image5 = new Image(100, 100, "e");
				var Image6 = new Image(100, 200, "f");
				Images.push(Image1);
				Images.push(Image2);
				Images.push(Image3);
				Images.push(Image4);
				Images.push(Image5);
				Images.push(Image6);
				
				var results = assignLinks(Images, Rectangles);
				
				var contents = document.getElementById('text').innerHTML;
				contents = contents + 	"<br/><br/>Result Set: <br/> - Results[0].url(): "+results[0].url+
										"<br/> - Results[1].url(): "+results[1].url+
										"<br/> - Results[2].url(): "+results[2].url+
										"<br/> - Results[3].url(): "+results[3].url+
										"<br/> - Results[4].url(): "+results[4].url+
										"<br/> - Results[5].url(): "+results[5].url;
				document.getElementById('text').innerHTML = contents; 
			};
				
			var Image = function (w, h, u) {
				var widthVal = w,
					heightVal = h,
					urlVal = u,
					aspRatVal = widthVal/heightVal;
				return {
					width: function () {return widthVal;},
					height: function () {return heightVal;},
					url: function () {return urlVal;},
					aspectRatio: function () {return aspRatVal;}
				};
			};

			var Rectangle = function (w, h) {
				var widthVal = w,
					heightVal = h,
					aspRatVal = widthVal/heightVal;
				return {
					width: function () {return widthVal;},
					height: function () {return heightVal;},
					aspectRatio: function () {return aspRatVal;}
				};
			};



			var assignLinks = function (images, rectangles){

				var notFound = true,
					squareNotFound = true,
					k = 0,
					j = 0,
					rectangle,
					temp = {url: "", dimension: [0, 0]},
					result = result = {url: "1", rectangle: "2"},
					results = [],
					indexOfImage = 0,
					currentType = 0;
					
				while( rectangles.length !== 0 ){
					
					rectangle = rectangles.pop(); 
					j = 0;
					notFound = true; 
					indexOfImage = 0;
					
					while(notFound){
					
						if(images[j].aspectRatio() < 0.75 ){
							currentType = 0.5; //4*2
						}else if(images[j].aspectRatio() > 1.25 ){
							currentType = 2; //2*4
						}else{
							currentType = 1; //square
						}
						
						if( rectangle.aspectRatio() === currentType ){
							
							indexOfImage = j; //correct match found
							notFound = false;
						}
						
						if( notFound && ( j === (images.length - 1 )) ){
						
							indexOfImage = 0;
							squareNotFound = true;
							k = 0; 
							
							//Find square
							while(squareNotFound){
							
								if(images[k].aspectRatio() < 0.75 ){
									currentType = 0.5; //4*2
								}else if(images[k].aspectRatio() > 1.25 ){
									currentType = 2; //2*4
								}else{
									currentType = 1; //square
								}
								
								if( currentType === 1 ){
									indexOfImage = k; //take first square
									squareNotFound = false;
								}
								
								//square not found
								if( squareNotFound && ( k === (images.length - 1 )) ){
									indexOfImage = 0; //take first image in the array
									squareNotFound = false;
								}
								k++;
							}
							notFound = false;
						}
						j++;
					}
					
					temp = images.slice(0, indexOfImage+1);
					var image = temp.pop();
					if(images.length !== 1){
						images = temp.concat(images.slice(indexOfImage+1, images.length));
					}
					result = {url: image.url(), rectangle: "4"}; 
					results.push(result)
				}
				return results; 
			};
		</script>
	</HEAD>
	<BODY onload="tester()">
		<div id="text"></div>
	
	</BODY>
</HTML>